{% extends "base.html" %}
{% block title %}Your Reviews | Byte Business{% endblock %}

{% block content %}
<div class="container">
  <section class="section">
    <div class="section-header">
      <div>
        <h2>Your reviews</h2>
        <p>Manage the ratings and notes you have shared.</p>
      </div>
      <a class="button subtle" href="{{ url_for('main.list_businesses') }}">Browse businesses</a>
    </div>

    {% if reviews and reviews|length > 0 %}
    <div class="card-grid">
      {% for review in reviews %}
      <div class="card">
        <div class="row" style="align-items: baseline;">
          <div>
            <h3 style="margin: 0;">{{ review.business.name|default('Business') }}</h3>
            <div class="business-meta" style="margin-top: 0.4rem;">
              <span class="star-bar" data-rating-bar data-rating="{{ review.rating|default(0) }}">
                <span class="base">★★★★★</span>
                <span class="fill">★★★★★</span>
              </span>
              <span class="muted">{{ review.rating|default(0) }}/5</span>
              <span class="pill">{{ review.business.category|default('Business') }}</span>
            </div>
          </div>
          <span class="muted">{{ review.created_at|default('') }}</span>
        </div>
        <p class="muted" style="margin-top: 0.6rem;">{{ review.comment|default('No comment provided.') }}</p>
        <div class="review-actions" style="margin-top: 0.8rem;">
          <a class="button subtle" href="{{ url_for('main.business_detail', business_id=review.business_id|default(0)) }}">View business</a>
          <a class="button subtle" href="{{ url_for('main.edit_review', review_id=review.id|default(0)) }}">Edit review</a>
          <form method="POST" action="{{ url_for('main.delete_review', review_id=review.id|default(0)) }}" class="review-action-form">
            <button class="button danger" type="submit">Delete</button>
          </form>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="card">
      <h3 style="margin-top: 0;">No reviews yet</h3>
      <p style="margin: 0.35rem 0 0.8rem;">Start by rating a business you have visited.</p>
      <a class="button" href="{{ url_for('main.list_businesses') }}">Find businesses</a>
    </div>
    {% endif %}
  </section>
</div>
{% endblock %}
